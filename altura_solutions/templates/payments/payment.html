{% load static %}
<div class="container text-center py-5">
    <h2 class="mb-4">Complete Your Payment</h2>
    <button id="checkout-button" class="btn btn-primary btn-lg">Check Out</button>
</div>

<script src="https://js.stripe.com/v3/"></script>

<script>
    const stripe = Stripe("{{ STRIPE_PUBLISHABLE_KEY }}");

    document.getElementById("checkout-button").addEventListener("click", async () => {
        const response = await fetch("{% url 'create-checkout-session' %}", {method: "POST"});
        const session = await response.json();
        const { error } = await stripe.redirectToCheckout({ sessionId: session.id });
        if (error){
            console.error(error);
            alert(error.message);
        }
    });
</script>
